<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pattern: Spot instances - IaC Cost Patterns</title>
    <link rel="stylesheet" href="https://search-rug.github.io/iac-cost-patterns/style.css?h=96c32b42161b5198cc11">
</head>
<body>
    <header>
        <div class="content-wrapper">
            <h1><a href="https:&#x2F;&#x2F;search-rug.github.io&#x2F;iac-cost-patterns&#x2F;">IaC Cost Patterns</a></h1>
            <p>A collection of patterns and antipatterns for managing cost in IaC files.</p>
            <ul>
                <li><a href="https://github.com/search-rug/iac-cost-patterns/blob/main/patterns.yml">Dataset <span class="label">YAML</span></a></li>
                <li><a href="https://github.com/search-rug/iac-cost-patterns">Repository</a></li>
            </ul>
        </div>
    </header>
    <main>
        <div class="content-wrapper">
            
<p class="nav"><a href="https:&#x2F;&#x2F;search-rug.github.io&#x2F;iac-cost-patterns&#x2F;">&leftarrow; Back to all patterns</a></p>
<h1 id="pattern-spot-instances">Pattern: Spot instances</h1>
<p>Use spot instances to run interruptible workloads for significant cost savings compared to regular instances.</p>
<h2 id="context">Context</h2>
<p>Continuously running compute instances are also continuously billed.
Certain types of workloads which can handle interruption, e.g. batch jobs,
data analysis and optional tasks, do not require on-demand, provisioned instances.</p>
<h2 id="solution">Solution</h2>
<p>Major cloud providers offer excess compute capacity in the form of spot instances.
These provide discounts over on-demand compute instances, with the caveat that instances
can be preempted or deleted at any time when compute capacity needs to be reclaimed.
Users define a price limit and if the spot price falls below this limit, an instance is allocated.
If a user's workloads can handle interruptions, spot instances can offer an economical
alternative to regular instances.</p>
<h2 id="example">Example</h2>
<p>Use spot instances to run batch jobs: if some of the instances are preempted,
the job is slowed down, but it does not completely stop. For example, request a
worker at a price of 0.03 USD:</p>
<pre data-lang="terraform" style="background-color:#2b303b;color:#c0c5ce;" class="language-terraform "><code class="language-terraform" data-lang="terraform"><span style="color:#b48ead;">resource </span><span>&quot;</span><span style="color:#a3be8c;">aws_spot_instance_request</span><span>&quot; &quot;</span><span style="color:#a3be8c;">cheap_worker</span><span>&quot; {
</span><span>  </span><span style="color:#65737e;"># ...
</span><span>  </span><span style="color:#bf616a;">spot_price    </span><span>= &quot;</span><span style="color:#a3be8c;">0.03</span><span>&quot;
</span><span>  </span><span style="color:#bf616a;">instance_type </span><span>= &quot;</span><span style="color:#a3be8c;">c4.xlarge</span><span>&quot;
</span><span>
</span><span>  </span><span style="color:#bf616a;">tags </span><span>= {
</span><span>    </span><span style="color:#bf616a;">Name </span><span>= &quot;</span><span style="color:#a3be8c;">Worker</span><span>&quot;
</span><span>  }
</span><span>}
</span></code></pre>
<h2 id="references">References</h2>
<ul>
<li><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-spot-instances.html">Spot Instances - Amazon Elastic Compute Cloud</a></li>
<li><a href="https://cloud.google.com/compute/docs/instances/spot">Spot VMs | Compute Engine Documentation | Google Cloud</a></li>
<li><a href="https://azure.microsoft.com/en-us/products/virtual-machines/spot/">Spot Virtual Machines - Spot Pricing and Features | Microsoft Azure</a></li>
<li><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/spot_instance_request">Resource: aws_spot_instance_request (Terraform)</a></li>
<li><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/spot_fleet_request">Resource: aws_spot_fleet_request (Terraform)</a></li>
<li><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#provisioning_model">Resource: google_compute_instance (Terraform) - Provisioning model</a></li>
<li><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/linux_virtual_machine#priority">Resource: azurerm_linux_virtual_machine (Terraform) - Priority</a></li>
</ul>
<h2 id="occurrences">Occurrences</h2>
<ul>
<li><a href="https://github.com/openinfrastructure/terraform-google-gitlab-runner/commit/8429375df72b04cc6fedc1ebb5f2c2e4ba18b9f2">https://github.com/openinfrastructure/terraform-google-gitlab-runner/commit/8429375df72b04cc6fedc1ebb5f2c2e4ba18b9f2</a></li>
<li><a href="https://github.com/kathputli/terraform-aws/commit/321b1aee88f7d15dafe46aede2b86ced70061025">https://github.com/kathputli/terraform-aws/commit/321b1aee88f7d15dafe46aede2b86ced70061025</a></li>
<li><a href="https://github.com/naciriii/terraform-ec2-gitlab-runner/commit/f8af6bc22bd3d827566e7e65deb63c13cdaf6031">https://github.com/naciriii/terraform-ec2-gitlab-runner/commit/f8af6bc22bd3d827566e7e65deb63c13cdaf6031</a></li>
<li><a href="https://github.com/Hapag-Lloyd/terraform-aws-bastion-host-ssm/commit/516075e2987bdd1063f22768d451c1c1eb647175">https://github.com/Hapag-Lloyd/terraform-aws-bastion-host-ssm/commit/516075e2987bdd1063f22768d451c1c1eb647175</a></li>
<li><a href="https://github.com/ToruMakabe/aks-anti-dry-iac/commit/4ba7a9dc3085ab701c85737a4f36dd57fcd7596f">https://github.com/ToruMakabe/aks-anti-dry-iac/commit/4ba7a9dc3085ab701c85737a4f36dd57fcd7596f</a></li>
<li><a href="https://github.com/paperphyte/terraform-drone/commit/79f4b7c2cf3ad2d1a6d2646eaf27a08fd2611d07">https://github.com/paperphyte/terraform-drone/commit/79f4b7c2cf3ad2d1a6d2646eaf27a08fd2611d07</a></li>
<li><a href="https://github.com/filhodanuvem/from-dev-to-ops/commit/998be8119321e8812884075b078a1d5fb36cfa69">https://github.com/filhodanuvem/from-dev-to-ops/commit/998be8119321e8812884075b078a1d5fb36cfa69</a></li>
<li><a href="https://github.com/stephaneclavel/terraform/commit/74b4ba406b9ea761d27298165d0e0de45c9d8491">https://github.com/stephaneclavel/terraform/commit/74b4ba406b9ea761d27298165d0e0de45c9d8491</a></li>
<li><a href="https://github.com/tale-toul/SingleNodeOpenshiftOnLibvirt/commit/638430604158044fcf123adaf8dfdcc91b1a873e">https://github.com/tale-toul/SingleNodeOpenshiftOnLibvirt/commit/638430604158044fcf123adaf8dfdcc91b1a873e</a></li>
<li><a href="https://github.com/JaredStufftGD/grok-airflow/commit/7ac9544b0c651fd8193eb063079514d0aa41e290">https://github.com/JaredStufftGD/grok-airflow/commit/7ac9544b0c651fd8193eb063079514d0aa41e290</a></li>
<li><a href="https://github.com/kaz/kiritan.com/commit/1cd96c7f71e56629ffa07c38e12c4da19fcfc5f7">https://github.com/kaz/kiritan.com/commit/1cd96c7f71e56629ffa07c38e12c4da19fcfc5f7</a></li>
<li><a href="https://github.com/openinfrastructure/terraform-google-multinic/commit/7a9c468b88d2edee19007cff6529a20a38eeb363">https://github.com/openinfrastructure/terraform-google-multinic/commit/7a9c468b88d2edee19007cff6529a20a38eeb363</a></li>
</ul>


        </div>
    </main>
    <footer>
        <div class="content-wrapper">
            <p>
                &copy; 2024
                <a href="https://koen.bolhu.is">Koen Bolhuis</a>,
                <a href="https://feitosa-daniel.github.io">Daniel Feitosa</a>,
                <a href="https://vandriko.github.io">Vasilios Andrikopoulos</a>
            </p>
        </div>
    </footer>
</body>
</html>
